
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="description" content="Instructions for setting up Xiaomi Mi Jia bluetooth-based temperature and humidity sensors in esphomelib.">
<meta name="keywords" content="Xiaomi, Mi Jia, BLE, Bluetooth">
<meta itemprop="name" content="Xiaomi MiJia BLE Sensor">
<meta itemprop="description" content="Instructions for setting up Xiaomi Mi Jia bluetooth-based temperature and humidity sensors in esphomelib.">
<meta itemprop="image" content="https://esphomelib.com/_images/xiaomi_miflora.jpg">
<meta name="twitter:title" content="Xiaomi MiJia BLE Sensor">
<meta name="twitter:image:src" content="https://esphomelib.com/_images/xiaomi_miflora.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Instructions for setting up Xiaomi Mi Jia bluetooth-based temperature and humidity sensors in esphomelib.">
<meta property="og:title" content="Xiaomi MiJia BLE Sensor"/>
<meta property="og:image" content="https://esphomelib.com/_images/xiaomi_miflora.jpg"/>
<meta property="og:type" content="website"/>
<meta property="og:site_name" content="esphomelib"/>
<meta property="og:description" content="Instructions for setting up Xiaomi Mi Jia bluetooth-based temperature and humidity sensors in esphomelib."/>
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="theme-color" content="#DFDFDF">

    <title>Xiaomi MiJia BLE Sensor &#8212; esphomelib 1.9.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/disqus.js"></script>
    <link rel="canonical" href="https://esphomelib.com/esphomeyaml/components/sensor/xiaomi_mijia.html" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Switch Component" href="../switch/index.html" />
    <link rel="prev" title="Xiaomi MiFlora BLE Sensor" href="xiaomi_miflora.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
    <link rel="apple-touch-icon" href="../../../_static/apple-touch-icon.png" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/logo-full.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Xiaomi MiJia BLE Sensor</a><ul>
<li><a class="reference internal" href="#configuration-variables">Configuration variables:</a></li>
<li><a class="reference internal" href="#setting-up-devices">Setting Up Devices</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="xiaomi-mijia-ble-sensor">
<h1>Xiaomi MiJia BLE Sensor<a class="headerlink" href="#xiaomi-mijia-ble-sensor" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">xiaomi_mijia</span></code> sensor platform lets you track the output of Xiaomi MiJia Bluetooth Low Energy
devices using the <a class="reference internal" href="../esp32_ble_tracker.html"><span class="doc">ESP32 Bluetooth Low Energy Tracker Hub</span></a>. This component will track the
temperature, humidity and optionally the battery level of the MiJia device every time the sensor
sends out a BLE broadcast. Note that contrary to other implementations, esphomelib can track as many
MiJia devices at once as you want.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../../../_images/xiaomi_mijia-full.jpg"><img alt="../../../_images/xiaomi_mijia-full.jpg" src="../../../_images/xiaomi_mijia-full.jpg" style="width: 60.0%;" /></a>
<p class="caption"><span class="caption-text">Xiaomi MiJia Temperature and Humidity Sensor over BLE.</span></p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../../_images/xiaomi_mijia-ui.png"><img alt="../../../_images/xiaomi_mijia-ui.png" src="../../../_images/xiaomi_mijia-ui.png" style="width: 80.0%;" /></a>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span class="c1"># Example configuration entry</span>
<span class="l l-Scalar l-Scalar-Plain">esp32_ble_tracker</span><span class="p p-Indicator">:</span>

<span class="l l-Scalar l-Scalar-Plain">sensor</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">platform</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">xiaomi_mijia</span>
    <span class="l l-Scalar l-Scalar-Plain">mac_address</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">7A:80:8E:19:36:BA</span>
    <span class="l l-Scalar l-Scalar-Plain">temperature</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Xiaomi</span><span class="nv"> </span><span class="s">MiJia</span><span class="nv"> </span><span class="s">Temperature&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">humidity</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Xiaomi</span><span class="nv"> </span><span class="s">MiJia</span><span class="nv"> </span><span class="s">Humidity&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">battery_level</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Xiaomi</span><span class="nv"> </span><span class="s">MiJia</span><span class="nv"> </span><span class="s">Battery</span><span class="nv"> </span><span class="s">Level&quot;</span>
</pre></div>
</div>
<div class="section" id="configuration-variables">
<h2>Configuration variables:<a class="headerlink" href="#configuration-variables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>mac_address</strong> (<strong>Required</strong>, MAC Address): The MAC address of the Xiaomi MiJia device.</li>
<li><strong>temperature</strong> (<em>Optional</em>): The information for the temperature sensor.<ul>
<li><strong>name</strong> (<strong>Required</strong>, string): The name for the temperature sensor.</li>
<li><strong>id</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Set the ID of this sensor for use in lambdas.</li>
<li>All other options from <a class="reference internal" href="index.html#config-sensor"><span class="std std-ref">Sensor</span></a> and <a class="reference internal" href="../mqtt.html#config-mqtt-component"><span class="std std-ref">MQTT Component</span></a>.</li>
</ul>
</li>
<li><strong>humidity</strong> (<em>Optional</em>): The information for the humidity sensor<ul>
<li><strong>name</strong> (<strong>Required</strong>, string): The name for the humidity sensor.</li>
<li><strong>id</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Set the ID of this sensor for use in lambdas.</li>
<li>All other options from <a class="reference internal" href="index.html#config-sensor"><span class="std std-ref">Sensor</span></a> and <a class="reference internal" href="../mqtt.html#config-mqtt-component"><span class="std std-ref">MQTT Component</span></a>.</li>
</ul>
</li>
<li><strong>battery_level</strong> (<em>Optional</em>): The information for the battery level sensor<ul>
<li><strong>name</strong> (<strong>Required</strong>, string): The name for the humidity sensor.</li>
<li><strong>id</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Set the ID of this sensor for use in lambdas.</li>
<li>All other options from <a class="reference internal" href="index.html#config-sensor"><span class="std std-ref">Sensor</span></a> and <a class="reference internal" href="../mqtt.html#config-mqtt-component"><span class="std std-ref">MQTT Component</span></a>.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="setting-up-devices">
<h2>Setting Up Devices<a class="headerlink" href="#setting-up-devices" title="Permalink to this headline">¶</a></h2>
<p>To set up Xiaomi MiJia devices you first need to find their MAC Address so that esphomelib can
identify them. So first, create a simple configuration without any <code class="docutils literal notranslate"><span class="pre">xiaomi_mijia</span></code> entries like so:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span class="l l-Scalar l-Scalar-Plain">esp32_ble_tracker</span><span class="p p-Indicator">:</span>
</pre></div>
</div>
<p>After uploading the ESP32 will immediately try to scan for BLE devices such as the Xiaomi MiJia. When
it detects these sensors, it will automatically parse the BLE message print a message like this one:</p>
<div class="code highlight-yaml notranslate"><div class="highlight"><pre><span class="l l-Scalar l-Scalar-Plain">Xiaomi MiJia 7A:80:8E:19:36:BA Got temperature=23.4°C, humidity=65.0%</span>
</pre></div>
</div>
<p>Note that it can sometimes take some time for the first BLE broadcast to be received. You can speed up
the process by pressing the grey bluetooth button on the back of the device.</p>
<p>Then just copy the address (<code class="docutils literal notranslate"><span class="pre">7A:80:8E:19:36:BA</span></code>) into a new <code class="docutils literal notranslate"><span class="pre">sensor.xiaomi_mijia</span></code> platform entry like
in the configuration example at the top.</p>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../esp32_ble_tracker.html"><span class="doc">ESP32 Bluetooth Low Energy Tracker Hub</span></a></li>
<li><a class="reference internal" href="xiaomi_miflora.html"><span class="doc">Xiaomi MiFlora BLE Sensor</span></a></li>
<li><a class="reference internal" href="index.html"><span class="doc">Sensor Component</span></a></li>
<li><a class="reference internal" href="../../../api/misc/esp32_ble_tracker.html"><span class="doc">API Reference</span></a></li>
<li><a class="reference external" href="https://github.com/mspider65/Xiaomi-Mijia-Bluetooth-Temperature-and-Humidity-Sensor">Xiaomi Mijia BLE protocol</a> by <a class="reference external" href="https://github.com/mspider65">&#64;mspider65</a></li>
<li><a class="reference external" href="https://github.com/1technophile/OpenMQTTGateway">OpenMQTTGateway</a> by <a class="reference external" href="https://github.com/1technophile">&#64;1technophile</a></li>
<li><a class="reference external" href="https://github.com/OttoWinter/esphomedocs/blob/current/esphomeyaml/components/sensor/xiaomi_mijia.rst">Edit this page on GitHub</a></li>
</ul>
<div data-disqus-identifier="esphomeyaml-components-sensor-xiaomi_mijia" id="disqus_thread"></div></div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      
      
      
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>